#include <iostream>

/*
 * 原题见: https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=1&id=4751&page=1
 * 原题为同目录下的 rev100
 */

int main()
{
    // 把文本提取出来
    unsigned char text[] =
    {
		104, 102, 108,   0,   0,  72, 191,   1,   0,   0,
		0,   0,   0,   0,   0,  72, 141,  52,  36,  72,
		186,   2,   0,   0,   0,   0,   0,   0,   0,  72,
		184,   1,   0,   0,   0,   0,   0,   0,   0,  15,
		5, 104,  97, 103,   0,   0,  72, 191,   1,   0,
		0,   0,   0,   0,   0,   0,  72, 141,  52,  36,
		72, 186,   2,   0,   0,   0,   0,   0,   0,   0,
		72, 184,   1,   0,   0,   0,   0,   0,   0,   0,
		15,   5, 104, 123, 112,   0,   0,  72, 191,   1,
		0,   0,   0,   0,   0,   0,   0,  72, 141,  52,
		36,  72, 186,   2,   0,   0,   0,   0,   0,   0,
		0,  72, 184,   1,   0,   0,   0,   0,   0,   0,
		0,  15,   5, 104, 111, 112,   0,   0,  72, 191,
		1,   0,   0,   0,   0,   0,   0,   0,  72, 141,
		52,  36,  72, 186,   2,   0,   0,   0,   0,   0,
		0,   0,  72, 184,   1,   0,   0,   0,   0,   0,
		0,   0,  15,   5, 104, 112, 111,   0,   0,  72,
		191,   1,   0,   0,   0,   0,   0,   0,   0,  72,
		141,  52,  36,  72, 186,   2,   0,   0,   0,   0,
		0,   0,   0,  72, 184,   1,   0,   0,   0,   0,
		0,   0,   0,  15,   5, 104, 112, 114,   0,   0,
		72, 191,   1,   0,   0,   0,   0,   0,   0,   0,
		72, 141,  52,  36,  72, 186,   2,   0,   0,   0,
		0,   0,   0,   0,  72, 184,   1,   0,   0,   0,
		0,   0,   0,   0,  15,   5, 104, 101, 116,   0,
		0,  72, 191,   1,   0,   0,   0,   0,   0,   0,
		0,  72, 141,  52,  36,  72, 186,   2,   0,   0,
		0,   0,   0,   0,   0,  72, 184,   1,   0,   0,
		0,   0,   0,   0,   0,  15,   5, 104, 125,  10,
		0,   0,  72, 191,   1,   0,   0,   0,   0,   0,
		0,   0,  72, 141,  52,  36,  72, 186,   2,   0,
		0,   0,   0,   0,   0,   0,  72, 184,   1,   0,
		0,   0,   0,   0,   0,   0,  15,   5,  72,  49,
		255,  72, 184,  60,   0,   0
    };

	std::string flag;
	
	// 过滤掉没用的字符(不可能是flag内容的)
	for(auto i : text)
	{
		if(i > 32 && i < 127)
		{
			flag.push_back(i);
		}
	}

	// 到这里结果是 hflHH4$HHhagHH4$HHh{pHH4$HHhopHH4$HHhpoHH4$HHhprHH4$HHhetHH4$HHh}HH4$HHH1H<
	// 可以看出中间有一段 HH4$HHh 是重复多次的,直接去掉
	size_t pos = 0;
	while ((pos = flag.find("HH4$HHh")) != size_t(-1))
	{
		flag.erase(pos, 7);
	}

	// 到这里结果是 hflag{poppopret}HH4$HHH1H<
	// 此时我们已经可以基本确认flag就是 poppopret 了
	
	std::cout << flag << std::endl;
}
